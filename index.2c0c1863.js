(L=S||(S={}))[L.Exploration=0]="Exploration",L[L.Combat=1]="Combat",L[L.Place=2]="Place";class e{constructor(e,t,s,a,i,r,n){if(this._choices=[],this._items=[],this._title=e,this._subtitle=t,this._description=s,this._image=a,i.length>4)throw RangeError("Four is the limit of choices per event");this._choices=i,this._type=r,this._items=n}get title(){return this._title}get subtitle(){return this._subtitle}get description(){return this._description}get image(){return this._image}get choices(){return this._choices}get type(){return this._type}get items(){return this._items}willGiveItems(){return!!this._items&&this._items.length>0}}(f=b||(b={}))[f.TRAVEL=0]="TRAVEL",f[f.EVENT=1]="EVENT",f[f.SKILLCHECK=2]="SKILLCHECK",f[f.GAME_OVER=3]="GAME_OVER",f[f.RIP=4]="RIP",f[f.LOG=5]="LOG",f[f.BAG=6]="BAG",f[f.ITEM_PICKER=7]="ITEM_PICKER",f[f.DIALOG=8]="DIALOG",f[f.MAP=9]="MAP",f[f.SKILL_UP=10]="SKILL_UP",(E=M||(M={}))[E.Result=0]="Result",E[E.StatusChange=1]="StatusChange";class t{constructor(){this._tempResultLogs=[],this._tempoStatusChangeLogs=[],this._logs=[],this._game=J.getInstance(),this._logListResult=document.querySelector("#log-list-result"),this._logListStatusChange=document.querySelector("#log-list-status-change"),this._travelBtn=document.querySelector("#log-back-character-btn"),this._travelBtn.addEventListener("click",()=>{this.onClickTravel()})}start(){this._travelBtn.disabled=!0,this.showLogs()}showLogs(){this._logs=this._tempoStatusChangeLogs,this._tempoStatusChangeLogs=[],this._logListResult.innerHTML="",this._logListStatusChange.innerHTML="",this.showResultLogs()}showResultLogs(){let e=0,t="",s=setInterval(()=>{e<this._tempResultLogs.length?(this._game.audioManager.playWriteSound(),t+="<li>"+this._tempResultLogs[e]+"</li>",this._logListResult.innerHTML=t,e++):(this._game.audioManager.playDingSound(),clearInterval(s),this._logs=this._tempResultLogs,this._tempResultLogs=[],this._logListStatusChange.innerHTML=this.createLogsForStatusChange(),this._game.characterManager.savePreviousCharacters(),this._travelBtn.disabled=!1)},800)}createLogsForStatusChange(){let e=this._game.characterManager.previousCharacters,t=this._game.characterManager.characters,s="";for(let a=0;a<e.length;a++){let i=e[a],r=t[a];r.isDead||i.health==r.health&&i.hungry==r.hungry&&i.stamina==r.stamina||(s+="<li> "+r.name+" ",i.health!=r.health&&(i.health>r.health?s+="❤️ -"+(i.health-r.health)+"% ":s+="❤️ +"+(r.health-i.health)+"% "),i.hungry!=r.hungry&&(i.hungry>r.hungry?s+="\uD83E\uDD6B -"+(i.hungry-r.hungry)+"% ":s+="\uD83E\uDD6B +"+(r.hungry-i.hungry)+"% "),i.stamina!=r.stamina&&(i.stamina>r.stamina?s+="⚡ -"+(i.stamina-r.stamina)+"% ":s+="⚡ +"+(r.stamina-i.stamina)+"% "),s+="</li>")}return s}clearLogs(){this._logListResult.innerHTML="",this._logListStatusChange.innerHTML=""}onClickTravel(){for(let e of(this._game.audioManager.playButtonSound(),this._game.characterManager.getCharactersDead()))if(e.isDead&&!e.buried){this._game.stateManager.goToState(b.RIP);return}this._game.stateManager.goToState(b.TRAVEL)}isThereAnyTemporaryLog(){return this._tempResultLogs.length>0||this._tempoStatusChangeLogs.length>0}addTempLog(e,t){0==t?this._tempResultLogs.push(e):1==t&&this._tempoStatusChangeLogs.push(e)}}(T=B||(B={}))[T.STRENGTH=0]="STRENGTH",T[T.SPEAK=1]="SPEAK",T[T.STEALTH=2]="STEALTH",T[T.EXPLORATION=3]="EXPLORATION",(v=A||(A={}))[v.TRIVIAL=0]="TRIVIAL",v[v.EASY=1]="EASY",v[v.MEDIUM=2]="MEDIUM",v[v.CHALLENGING=3]="CHALLENGING",v[v.VERY_HARD=4]="VERY_HARD",v[v.IMPOSSIBILE=5]="IMPOSSIBILE";class s{constructor(e,t,s,a,i,r=""){this._name=e,this._type=t,this._attack=s,this._runAway=a,this._timesThatAppears=i,this._imageUrl=r}get name(){return this._name}get attack(){return this._attack}get runAway(){return this._runAway}}(w=R||(R={}))[w.WildAnimal=0]="WildAnimal",w[w.Human=1]="Human",w[w.Supernatural=2]="Supernatural";class a{static{this.enemies=[new s("Angry dog",0,A.CHALLENGING,A.VERY_HARD,3,"https://pixabay.com/photos/dog-angry-aggressive-white-black-5287546/"),new s("Wild dog",0,A.MEDIUM,A.CHALLENGING,3,"https://pixabay.com/photos/dog-angry-rage-violent-furious-486550/"),new s("Hungry wild wolf",0,A.VERY_HARD,A.CHALLENGING,1,"https://pixabay.com/photos/wolf-predator-hunter-canis-lupus-635063/"),new s("Swarm of bees",0,A.IMPOSSIBILE,A.CHALLENGING,1,"https://pixabay.com/photos/bees-insects-macro-honey-bees-276190/"),new s("Cloud of insects",0,A.IMPOSSIBILE,A.MEDIUM,1),new s("Hungry fox",0,A.CHALLENGING,A.MEDIUM,1),new s("Brown bear",0,A.VERY_HARD,A.VERY_HARD,1),new s("Amur tiger",0,A.IMPOSSIBILE,A.VERY_HARD,1,"https://pixabay.com/photos/tiger-animal-roar-fangs-angry-5946115/"),new s("Grey wolf",0,A.VERY_HARD,A.CHALLENGING,1),new s("White bear",0,A.VERY_HARD,A.CHALLENGING,1),new s("Wild boar",0,A.MEDIUM,A.EASY,1),new s("Northern viper",0,A.MEDIUM,A.EASY,1),new s("Eurasian Lynx",0,A.CHALLENGING,A.MEDIUM,1),new s("Deer",0,A.MEDIUM,A.EASY,3),new s("Siberian Tiger",0,A.IMPOSSIBILE,A.VERY_HARD,1),new s("Wild Boar",0,A.VERY_HARD,A.MEDIUM,3),new s("Deformed rats",0,A.MEDIUM,A.EASY,3),new s("Flock of crows",0,A.VERY_HARD,A.EASY,2),new s("Locust cloud",0,A.IMPOSSIBILE,A.TRIVIAL,2),new s("Swarm of flies",0,A.IMPOSSIBILE,A.MEDIUM,2),new s("Pigs with worms in the body",0,A.VERY_HARD,A.CHALLENGING,1),new s("Sick human",1,A.MEDIUM,A.EASY,3),new s("Thief with ax",1,A.VERY_HARD,A.CHALLENGING,1),new s("Militia hunter",1,A.IMPOSSIBILE,A.CHALLENGING,1),new s("Man crawling with a knife",1,A.VERY_HARD,A.MEDIUM,1),new s("Two militia hunters",1,A.IMPOSSIBILE,A.VERY_HARD,1),new s("Dark figure",2,A.IMPOSSIBILE,A.TRIVIAL,2),new s("Woman with two faces",2,A.VERY_HARD,A.CHALLENGING,1),new s("Eyeless creature",2,A.IMPOSSIBILE,A.MEDIUM,1),new s("Anomaly",2,A.IMPOSSIBILE,A.MEDIUM,3),new s("Ghost",2,A.IMPOSSIBILE,A.EASY,4)]}static getOneRandomEnemy(){return a.enemies[a.getRandomArbitrary(0,a.enemies.length)]}static getRandomArbitrary(e,t){return Math.floor(Math.random()*(t-e)+e)}}class i{constructor(){this._game=J.getInstance(),this._events=[]}start(){this.events.push(new e("Wild Wolf Appeared","Something that catches your eye","He jumps furiously wanting blood!","",[{buttonText:"Throw a stone",skillCheck:!1,skillCheckFields:null,normalResultPath:()=>{this._game.log.addTempLog("You hit the rock and killed the wolf!",M.Result)}},{buttonText:"Run like a chicken",skillCheck:!1,skillCheckFields:null,normalResultPath:()=>{this._game.log.addTempLog("Did you get away",M.Result)}}],S.Combat,null))}get events(){return this._events}getPlaceEvent(){let t=[new e("Ferris wheel","When you look up you feel a chill in your belly","It seems like it’s not been used for a long time, a time when having fun still made sense","ferris-wheel",[{buttonText:"Take a deep breath",skillCheck:!1,skillCheckFields:null,normalResultPath:()=>{this._game.log.addTempLog("You don't find anything interesting",M.Result),this._game.log.addTempLog("Just look at the ferris wheel for a while, take a deep breath and walk away",M.Result),this._game.characterManager.makeSomeoneInTheGroupGetStatus()}},{buttonText:"Investigate",skillCheck:!0,skillCheckFields:{difficulty:A.MEDIUM,skillToCheck:B.STRENGTH,canGiveItems:!0,resultPath:{success:()=>{this._game.log.addTempLog("You found some things of value",M.Result)},failure:()=>{this._game.log.addTempLog("You couldn't find anything",M.Result)}}},normalResultPath:null},{buttonText:"Continue the walk",skillCheck:!1,skillCheckFields:null,normalResultPath:()=>{this._game.log.addTempLog("You just go by the ferris wheel and go away, without looking back",M.Result)}}],S.Combat,null),new e("Abandoned Barn","Just a normal place","There is something unsettling about this place","barn-abandoned-farm-homestead",[{buttonText:"Investigate",skillCheck:!0,skillCheckFields:{difficulty:A.CHALLENGING,skillToCheck:B.STRENGTH,canGiveItems:!0,resultPath:{success:()=>{this._game.log.addTempLog("You found some things of value",M.Result)},failure:()=>{this._game.log.addTempLog("You couldn't find anything",M.Result)}}},normalResultPath:null},{buttonText:"Continue",skillCheck:!1,skillCheckFields:null,normalResultPath:()=>{this._game.log.addTempLog("You just continue walking...",M.Result)}}],S.Combat,null),new e("Theme Park","Just a normal place","This place brings you strange memories, about sad things","theme-park",[{buttonText:"Forget memory",skillCheck:!0,skillCheckFields:{difficulty:A.MEDIUM,skillToCheck:B.STRENGTH,canGiveItems:!1,resultPath:{success:()=>{this._game.log.addTempLog("You managed to overcome the negative memories",M.Result)},failure:()=>{this._game.characterManager.makeSomeoneInTheGroupGetStatus("Depressed")}}},normalResultPath:null},{buttonText:"Just ignore.",skillCheck:!1,skillCheckFields:null,normalResultPath:()=>{this._game.log.addTempLog("You just continue walking...",M.Result)}}],S.Combat,null),new e("Forest Fog","Just a normal place","There is something unsettling about this place","forest-fog",[{buttonText:"Continue",skillCheck:!1,skillCheckFields:null,normalResultPath:()=>{this._game.log.addTempLog("You just continue walking...",M.Result)}}],S.Combat,null),new e("Geyser","Just a normal place","There is something unsettling about this place","geyser",[{buttonText:"Continue",skillCheck:!1,skillCheckFields:null,normalResultPath:()=>{this._game.log.addTempLog("You just continue walking...",M.Result)}}],S.Combat,null)];return t[Math.floor(Math.random()*t.length)]}getCombatEvent(){let t=a.getOneRandomEnemy(),s=["Approaches more and more with an aggressive posture.","Closer and closer, making avoiding conflict almost impossible","Appears suddenly scaring everyone","Appears from the dark in a sadistic way","An inevitable encounter in this place","Hard to avoid conflict"],i=s[Math.floor(Math.random()*s.length)];return new e(t.name,"Conflict",i,"2",[{buttonText:"Attack",skillCheck:!0,skillCheckFields:{difficulty:t.attack,skillToCheck:B.STRENGTH,canGiveItems:!1,resultPath:{success:()=>{this._game.log.addTempLog("You managed to scare the "+t.name.toLowerCase()+" and run away.",M.Result)},failure:()=>{this._game.characterManager.decreasesTheHealthOfSomeoneInTheGroup(),this._game.characterManager.makeSomeoneInTheGroupGetStatus("Wounds"),this._game.log.addTempLog("You were attacked but managed to escape.",M.Result)}}},normalResultPath:null},{buttonText:"Run away",skillCheck:!0,skillCheckFields:{difficulty:t.runAway,skillToCheck:B.STRENGTH,canGiveItems:!1,resultPath:{success:()=>{this._game.log.addTempLog("You managed to escape.",M.Result)},failure:()=>{this._game.characterManager.decreasesTheHealthOfSomeoneInTheGroup(),this._game.characterManager.makeSomeoneInTheGroupGetStatus("Fear"),this._game.log.addTempLog("You escaped but got hurt by the "+t.name.toLowerCase(),M.Result)}}},normalResultPath:null}],S.Combat,null)}getMileStoneEvent(){return new e("Milestone Reached! ","Something that catches your eye",this._game.distanceToTheBorder+" miles to the border","milestone",[{buttonText:"Back to travel",skillCheck:!1,skillCheckFields:null,normalResultPath:()=>{}}],S.Exploration,null)}}class r{constructor(e){this.percentageTable={2:97,3:97,4:92,5:83,6:73,7:59,8:42,9:28,10:17,11:9,12:3},this.diceSize=150,this.cornerRadius=20,this.dotRadius=10,this.positions=[[],[[0,0]],[[-1,-1],[1,1]],[[-1,-1],[0,0],[1,1]],[[-1,-1],[-1,1],[1,-1],[1,1]],[[-1,-1],[-1,1],[0,0],[1,-1],[1,1]],[[-1,-1],[-1,0],[-1,1],[1,-1],[1,0],[1,1]]]}start(){}getDifficult(e){switch(e){case A.TRIVIAL:return{value:this.getRandomNumber(3,5),text:"Trivial",class:"green-color-border"};case A.EASY:return{value:this.getRandomNumber(6,8),text:"Easy",class:"green-color-border"};case A.MEDIUM:return{value:this.getRandomNumber(9,11),text:"Medium",class:"green-color-border"};case A.CHALLENGING:return{value:this.getRandomNumber(12,14),text:"Challenging",class:"yellow-color-border"};case A.VERY_HARD:return{value:this.getRandomNumber(15,17),text:"Very Hard",class:"red-color-border"};case A.IMPOSSIBILE:return{value:this.getRandomNumber(18,20),text:"Impossibile",class:"red-color-border"}}}calculateProbabilityFrom(e){return e>12&&(e=12),e<=1&&(e=2),this.percentageTable[e]+"%"}getRandomNumber(e,t){let s=Math.ceil(e);return Math.floor(Math.random()*(Math.floor(t)-s+1))+s}drawRoundedRect(e,t,s,a,i){this.ctx.beginPath(),this.ctx.moveTo(e+i,t),this.ctx.arcTo(e+s,t,e+s,t+a,i),this.ctx.arcTo(e+s,t+a,e,t+a,i),this.ctx.arcTo(e,t+a,e,t,i),this.ctx.arcTo(e,t,e+s,t,i),this.ctx.closePath(),this.ctx.fillStyle="black",this.ctx.fill(),this.ctx.lineWidth=5,this.ctx.strokeStyle="white",this.ctx.stroke()}drawDots(e){let t=this.canvas.width/2,s=this.canvas.height/2,a=this.diceSize/4;this.ctx.fillStyle="white",this.positions[e].forEach(([e,i])=>{this.ctx.beginPath(),this.ctx.arc(t+e*a,s+i*a,this.dotRadius,0,2*Math.PI),this.ctx.fill()})}drawDice(e){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);let t=(this.canvas.width-this.diceSize)/2,s=(this.canvas.height-this.diceSize)/2;this.drawRoundedRect(t,s,this.diceSize,this.diceSize,this.cornerRadius),this.drawDots(e)}getRandomDiceValue(){return Math.floor(6*Math.random())+1}animateDice(){setInterval(()=>{let e=this.getRandomDiceValue();this.drawDice(e)},1e3)}}class n{constructor(){this._titleElement=document.getElementById("event-page-title"),this._descriptionElement=document.getElementById("event-page-description"),this._photographyBorder=document.querySelector(".photography-border"),this._eventPageChoicesBtnListElement=document.getElementById("event-page-choices-btn-list"),this._subtitleElement=document.getElementById("event-page-subtitle"),this._imageElement=document.getElementById("event-page-image"),this._game=J.getInstance()}start(){this._eventPageChoicesBtnListElement.innerHTML="";let e=new i;e.start(),e.events;let t=this._game.getRandomArbitrary(2);this.checkForMileStone()?this._currentEvent=e.getMileStoneEvent():0==t?this._currentEvent=e.getPlaceEvent():this._currentEvent=e.getCombatEvent(),this.showWaitingMessage()}showChoices(){this._eventPageChoicesBtnListElement.innerHTML="";let e=new r;for(let t of this.currentEvent.choices){let s=document.createElement("button");if(t.skillCheck){t.skillCheckFields.difficult=e.getDifficult(t.skillCheckFields.difficulty);let a=t.buttonText+" ["+t.skillCheckFields.difficult.text+": "+t.skillCheckFields.difficult.value+" - "+e.calculateProbabilityFrom(t.skillCheckFields.difficult.value-3)+"]";s.appendChild(document.createTextNode(a)),s.classList.add(t.skillCheckFields.difficult.class)}else s.appendChild(document.createTextNode(t.buttonText));s.addEventListener("click",()=>this.selectChoice(t)),this._eventPageChoicesBtnListElement.appendChild(s)}}selectChoice(e){if(this._game.audioManager.playButtonSound(),this.currentChoice=e,this.currentChoice.skillCheck){this._game.stateManager.goToState(b.SKILLCHECK);return}if(this.currentEvent.type==S.Place&&"Investigate"==e.buttonText){this._game.stateManager.goToState(b.ITEM_PICKER);return}this.currentChoice.normalResultPath(),this.checkLogs()}get currentEvent(){return this._currentEvent}checkForMileStone(){return 250==this._game.distanceToTheBorder||200==this._game.distanceToTheBorder||150==this._game.distanceToTheBorder||100==this._game.distanceToTheBorder||50==this._game.distanceToTheBorder}showWaitingMessage(){this._titleElement.style.display="none",this._subtitleElement.style.display="none",this._photographyBorder.style.display="none",this._descriptionElement.innerHTML="Something happened!",this._imageElement.style.display="none",setTimeout(()=>this.showEvent(),1e3)}showEvent(){this._titleElement.style.display="block",this._subtitleElement.style.display="block",this._photographyBorder.style.display="block",this._titleElement.innerHTML=this._currentEvent.title,this._subtitleElement.innerHTML=this._currentEvent.subtitle,this._descriptionElement.innerHTML=this._currentEvent.description,""!=this._currentEvent.image&&(this._imageElement.src="img\\places\\"+this._currentEvent.image+".jpg"),this._imageElement.style.display="block",this.showChoices()}checkLogs(){this._game.log.isThereAnyTemporaryLog()?this._game.stateManager.goToState(b.LOG):this._game.stateManager.goToState(b.TRAVEL)}}class h{constructor(){this._game=J.getInstance(),this._gameOverMessage=document.querySelector("#game-over-message"),this._tryAgainBtn=document.querySelector("#try-again-btn")}start(){this._tryAgainBtn.addEventListener("click",()=>{this.onClickTryAgainBtn()}),this.setGameOverMessage("You died with "+this._game.distanceToTheBorder+" miles to the border")}onClickTryAgainBtn(){this._game.audioManager.playButtonSound(),location.reload()}setGameOverMessage(e){this._gameOverMessage.innerHTML=e}}class o{constructor(){this._game=J.getInstance(),this._ripPageImageElement=document.querySelector("#rip-page-image"),this._ripPageNameElement=document.querySelector("#rip-page-name"),this._ripPageDatesElement=document.querySelector("#rip-page-dates"),this._ripPageQuoteElement=document.querySelector("#rip-page-quote"),this._ripPageStatusElement=document.querySelector("#rip-page-status"),this._travelBtn=document.querySelector("#rip-page-back-btn"),this._travelBtn.addEventListener("click",()=>{this.onClickTravel()})}start(){let e=this._game.characterManager.getFirstCharacterDeadAndNotBuried();this.showCharater(e),e.buried=!0}showCharater(e){this._ripPageImageElement.src=e.imageURL,this._ripPageNameElement.innerHTML=e.name+" Miller",this._ripPageDatesElement.innerHTML="⭐ 02/02/1996 - 20/03/2020 ✝️",this._ripPageQuoteElement.innerHTML="I pray you find peace and rest wherever you are",this._ripPageStatusElement.innerHTML='<span style="font-weight: bold;">Status:</span> Starved to death'}onClickTravel(){this._game.audioManager.playButtonSound();let e=this._game.characterManager.getFirstCharacterDeadAndNotBuried();null!=e?(this.showCharater(e),e.buried=!0):this._game.stateManager.goToState(b.TRAVEL)}}class l{constructor(){this._game=J.getInstance(),this._travelledDistanceField=document.querySelector("#travelled-distance"),this._progressBarCanvasElement=document.getElementById("progress-bar"),this._walkBtn=document.querySelector("#walk-btn"),this._campBtn=document.querySelector("#camp-btn"),this._yourFamily=document.querySelector("#your-family"),this._walkBtn.addEventListener("click",()=>{this.onClickWalkBtn()}),this._campBtn.addEventListener("click",()=>{this.onClickCampBtn()}),this.showTravelledDistance(),this._charactersList=[],this._bagBtn=document.querySelector("#bag-btn"),this._bagBtn.addEventListener("click",()=>{this.onClickBag()}),this.getAtributesPageElements()}start(){this.showProgressBarCanvas(),this._walkBtn.innerHTML=this._game.loc.l("walk-one-hour"),this._yourFamily.innerHTML=this._game.loc.l("your-family"),this._game.bagManager.isEmpty()?(this._bagBtn.innerHTML=this._game.loc.l("bag-is-empty"),this._bagBtn.disabled=!0):(this._bagBtn.disabled=!1,this._bagBtn.innerHTML="Open bag ("+this._game.bagManager.showQuantityOfItems()+") "),this.showCharacters(),this.checkCampBtn()}showProgressBarCanvas(){this._progressBarCanvasElement.width=300,this._progressBarCanvasElement.height=8,this._progressBarCanvasContext=this._progressBarCanvasElement.getContext("2d"),this.drawBackground(),console.log(this._game.distanceToTheBorder),this.drawPlayerPositionOnProgressBarCanvas(300-this._game.distanceToTheBorder)}drawBackground(){this._progressBarCanvasContext.clearRect(0,0,this._progressBarCanvasElement.width,this._progressBarCanvasElement.height),this._progressBarCanvasContext.beginPath(),this._progressBarCanvasContext.fillStyle="black",this._progressBarCanvasContext.fillRect(0,0,this._progressBarCanvasElement.width,this._progressBarCanvasElement.height),this._progressBarCanvasContext.strokeStyle="#2c3e50",this._progressBarCanvasContext.lineWidth=1,this._progressBarCanvasContext.moveTo(10,this._progressBarCanvasElement.height/2),this._progressBarCanvasContext.lineTo(290,this._progressBarCanvasElement.height/2),this._progressBarCanvasContext.stroke(),this._progressBarCanvasContext.moveTo(10,this._progressBarCanvasElement.height/2-5),this._progressBarCanvasContext.lineTo(10,this._progressBarCanvasElement.height/2+5),this._progressBarCanvasContext.stroke(),this._progressBarCanvasContext.moveTo(this._progressBarCanvasElement.width/2,this._progressBarCanvasElement.height/2-5),this._progressBarCanvasContext.lineTo(this._progressBarCanvasElement.width/2,this._progressBarCanvasElement.height/2+5),this._progressBarCanvasContext.stroke(),this._progressBarCanvasContext.moveTo(this._progressBarCanvasElement.width/4,this._progressBarCanvasElement.height/2-5),this._progressBarCanvasContext.lineTo(this._progressBarCanvasElement.width/4,this._progressBarCanvasElement.height/2+5),this._progressBarCanvasContext.stroke(),this._progressBarCanvasContext.moveTo(this._progressBarCanvasElement.width/4*3,this._progressBarCanvasElement.height/2-5),this._progressBarCanvasContext.lineTo(this._progressBarCanvasElement.width/4*3,this._progressBarCanvasElement.height/2+5),this._progressBarCanvasContext.stroke(),this._progressBarCanvasContext.moveTo(this._progressBarCanvasElement.width-10,this._progressBarCanvasElement.height/2-5),this._progressBarCanvasContext.lineTo(this._progressBarCanvasElement.width-10,this._progressBarCanvasElement.height/2+5),this._progressBarCanvasContext.stroke(),this._progressBarCanvasContext.beginPath(),this._progressBarCanvasContext.moveTo(this._progressBarCanvasElement.width-10,this._progressBarCanvasElement.height/2-5),this._progressBarCanvasContext.lineTo(this._progressBarCanvasElement.width-10,this._progressBarCanvasElement.height/2+5),this._progressBarCanvasContext.stroke(),this._progressBarCanvasContext.closePath()}drawPlayerPositionOnProgressBarCanvas(e){let t=this._progressBarCanvasElement.width-20;this._progressBarCanvasContext.beginPath(),this._progressBarCanvasContext.arc(t/300*e+10,this._progressBarCanvasElement.height/2,3.5,0,2*Math.PI),this._progressBarCanvasContext.lineWidth=0,this._progressBarCanvasContext.fillStyle="#27ae60",this._progressBarCanvasContext.fill()}onClickCampBtn(){this._bagBtn.disabled=!0,this._campBtn.disabled=!0,this._walkBtn.disabled=!0,this._yourFamily.innerHTML="Camping...",this._hoursSleeping=0,this._sleepIntervalId=window.setInterval(()=>this.sleeping(),500)}sleeping(){if(this._hoursSleeping<=6){let e=this._game.characters;for(let t=0;t<e.length;t++)if(!e[t].isDead){let e=this._game.getRandomArbitrary(3);this._charactersList[t].atributesField.innerHTML=0==e?"Zzz":1==e?"zZz":"zzZ"}this._game.passOneHour(),this._hoursSleeping++}else this._game.characterManager.increaseStaminaOfAllCharactersToMax(),this.showCharacters(),this._bagBtn.disabled=!1,this._campBtn.disabled=!1,this._walkBtn.disabled=!1,this._yourFamily.innerHTML=this._game.loc.l("your-family"),clearInterval(this._sleepIntervalId)}onClickWalkBtn(){if(300==this._game.distanceToTheBorder&&this._game.audioManager.playRainSound(),this._game.audioManager.playButtonSound(),this._game.passOneHour(),this.walkOneHour(),this.checkEvent())this._game.stateManager.goToState(b.EVENT);else if(this._game.log.isThereAnyTemporaryLog()){let e=this._game.characterManager.picksACharacterAtRandom(),t=[e.name+" is feeling anxious...",e.name+" is thoughtful...",e.name+" feels a tightness in the heart...","The family continued walking...","The walk was smooth...","Nothing different..."],s=t[this._game.getRandomArbitrary(t.length-1)];this._game.log.addTempLog(s,M.Result),this._game.stateManager.goToState(b.LOG)}this.checkCampBtn()}checkCampBtn(){this._game.isDayLight()?(this._campBtn.disabled=!0,this._campBtn.innerHTML="It's not safe to camp"):(this._campBtn.disabled=!1,this._campBtn.innerHTML="Camp (+6 hour)")}onClickBag(){this._game.audioManager.playButtonSound(),this._game.stateManager.goToState(b.BAG)}getAtributesPageElements(){this._charactersList[0]={},this._charactersList[0].nameField=document.querySelector("#first-character-name-field"),this._charactersList[0].atributesField=document.querySelector("#first-character-atributes-field"),this._charactersList[0].afflictionsField=document.querySelector("#first-character-afflictions-field"),this._charactersList[1]={},this._charactersList[1].nameField=document.querySelector("#second-character-name-field"),this._charactersList[1].atributesField=document.querySelector("#second-character-atributes-field"),this._charactersList[1].afflictionsField=document.querySelector("#second-character-afflictions-field"),this._charactersList[2]={},this._charactersList[2].nameField=document.querySelector("#third-character-name-field"),this._charactersList[2].atributesField=document.querySelector("#third-character-atributes-field"),this._charactersList[2].afflictionsField=document.querySelector("#third-character-afflictions-field"),this._charactersList[3]={},this._charactersList[3].nameField=document.querySelector("#fourth-character-name-field"),this._charactersList[3].atributesField=document.querySelector("#fourth-character-atributes-field"),this._charactersList[3].afflictionsField=document.querySelector("#fourth-character-afflictions-field")}showCharacters(){let e=this._game.characters;for(let t=0;t<e.length;t++){let s=e[t];if(s.isDead)this._charactersList[t].nameField.innerHTML=s.name+" - "+s.kinship+" \uD83D\uDC80",this._charactersList[t].atributesField.innerHTML=s.getDateOfBirth()+" - 2020",this._charactersList[t].afflictionsField.innerHTML="";else{let e=s.showHealthLostPerHourDueToAllStatus();this._charactersList[t].nameField.innerHTML=s.name+" - "+s.kinship,this._charactersList[t].nameField.innerHTML+="Sick"==s.getSickness()?" [ Sick ]":"",this._charactersList[t].atributesField.innerHTML=s.getHealth()+(0==e?" ":' <span class="character-afflictions-field">(-'+s.showHealthLostPerHourDueToAllStatus()+"%) </span>")+s.getStamina()+" "+s.getHungry(),this._charactersList[t].afflictionsField.innerHTML=s.showAfflictions()}}}checkEvent(){return 50>=this.getRandomArbitrary(1,100)}getRandomArbitrary(e,t){return Math.random()*(t-e)+e}walkOneHour(){for(let e of(this._game.characterManager.decreaseStaminaOfAllCharacters(5),this._game.characterManager.increaseHungryOfAllCharacters(),this._game.characterManager.getCharactersAlive()))e.walkOneHour();this._game.decreaseTheDistanceToTheBorder(2),this.showTravelledDistance(),this._game.distanceToTheBorder<=0&&this.arrivedAtTheBorder()}getRandomCharacter(){return Math.floor(Math.random()*this._game.characters.length)}showTravelledDistance(){this._travelledDistanceField.innerHTML=this._game.distanceToTheBorder+" "+this._game.loc.l("miles-to-the-border")}arrivedAtTheBorder(){this._game.stateManager.goToState(b.GAME_OVER)}}(I=P||(P={}))[I.FirstAid=0]="FirstAid",I[I.Food=1]="Food",I[I.Drink=2]="Drink";class c{constructor(e,t,s,a=[]){this._status=[],this._name=e,this._type=t,this._amount=0,this._effectValue=s,this._status=a}get name(){return this._name}get amount(){return this._amount}get type(){return this._type}get status(){return this._status}get effect(){let e="";switch(this._type){case 0:e+="❤️";break;case 1:e+="\uD83E\uDD6B"}return e+(" +"+this.effectValue)+"%"}get effectValue(){return this._effectValue}set amount(e){this._amount=e}showAmount(){return this._amount>1?" x "+this._amount:""}decreaseAmount(){this._amount--}increaseAmount(){this._amount++}showStatus(){if(0==this._status.length)return"";let e="";for(let t of this._status)t&&(e+=" -"+t.name);return e}}class u{constructor(){this._items=[],this._game=J.getInstance(),this._itemListElement=document.querySelector("#bag-item-list"),this._selectedItemElement=document.getElementById("bag-selected-item"),this._selectedItemDescriptionElement=document.getElementById("bag-selected-item-description"),this._bagCloseBtn=document.querySelector("#bag-close-btn"),this._bagThrowAwayBtn=document.getElementById("bag-throw-away-btn"),this._bagCloseBtn.addEventListener("click",()=>{this.onClickBagClose()}),this._bagThrowAwayBtn.addEventListener("click",()=>{this.onClickThrowAway()})}start(){this.hideSelectedItem(),this.showItems(),this._bagThrowAwayBtn.style.display="none"}onClickBagClose(){this._game.audioManager.playButtonSound(),this._game.stateManager.goToState(b.TRAVEL)}onClickThrowAway(){this._game.audioManager.playButtonSound(),this.removeOrDecreaseItem(),this._itemListElement.innerHTML="",this._selectedItemElement.style.display="none",this._selectedItemDescriptionElement.style.display="none",this.showItems(),this._bagThrowAwayBtn.style.display="none"}hideSelectedItem(){this._selectedItemElement.innerHTML="",this._selectedItemElement.style.display="none",this._selectedItemDescriptionElement.style.display="none"}showSelectedItem(){this._selectedItemElement.style.display="block",this._selectedItem.type==P.FirstAid&&(this._selectedItemDescriptionElement.style.display="block")}showItems(){if(this._itemListElement.innerHTML="",0==this._items.length){this._itemListElement.innerHTML="Empty";return}for(let e of this._items){let t=document.createElement("li"),s=document.createElement("button");s.appendChild(document.createTextNode(e.name+" ("+e.effect+") "+e.showAmount())),s.addEventListener("click",()=>this.selectItem(e)),t.appendChild(s),this._itemListElement.appendChild(t)}}putItem(e){let t=this._items.findIndex(t=>t.name==e.name);t>=0?this._items[t].increaseAmount():this._items.push(e)}showCharacters(){for(let t of this._game.characters){let s=document.createElement("li"),a=document.createElement("button");a.classList.add("bag-item");let i=t.name;var e=document.createElement("p");if(t.isDead)a.disabled=!0,e.classList.add("line"),e.style.color="#2c3e50";else switch(this._selectedItem.type){case P.FirstAid:i+=t.getHealth()+t.showAfflictions();break;case P.Food:i+=t.getHungry()}e.appendChild(document.createTextNode(i)),a.appendChild(e),a.addEventListener("click",()=>this.useItem(t)),s.appendChild(a),this._itemListElement.appendChild(s)}}selectItem(e){this._selectedItem=e,this._itemListElement.innerHTML="",this._selectedItemElement.innerHTML=`Give ${this._selectedItem.name} ${this._selectedItem.effect} to:`,this._selectedItem.type==P.FirstAid&&(this._selectedItemDescriptionElement.innerHTML="Can help with "+this._selectedItem.showStatus()),this.showSelectedItem(),this.showCharacters(),this._bagThrowAwayBtn.style.display="block"}useItem(e){switch(this.removeOrDecreaseItem(),this.hideSelectedItem(),this.showItems(),this._selectedItem.type){case P.FirstAid:e.increaseHealth(this._selectedItem.effectValue);break;case P.Food:e.decreaseHungry(this._selectedItem.effectValue)}for(let t of this._selectedItem.status)e.removeStatus(t);this._bagThrowAwayBtn.style.display="none"}removeOrDecreaseItem(){this._selectedItem.amount>1?this._selectedItem.decreaseAmount():this.removeItem(this._selectedItem.name)}removeItem(e){this._items=this._items.filter(t=>t.name!==e)}checksIfAnItemExists(e){return -1!=this._items.findIndex(t=>t.name==e)}isEmpty(){return this._items.length<=0}showQuantityOfItems(){let e=0;for(let t=0;t<this._items.length;t++)e+=0==this._items[t].amount?1:this._items[t].amount;return e}}class m{constructor(){this.currentState=b.TRAVEL,this._game=J.getInstance()}start(){}setState(){switch(this._game.hideAllPages(),this.currentState){case b.TRAVEL:this._game.showPage(this._game.travelPage),this._game.travelManager.start();break;case b.EVENT:this._game.showPage(this._game.eventPage),this._game.eventManager.start();break;case b.SKILLCHECK:this._game.showPage(this._game.skillCheckPage),this._game.skillCheckManager.start();break;case b.LOG:this._game.showPage(this._game.logPage),this._game.logManager.start();break;case b.GAME_OVER:this._game.showPage(this._game.gameOverPage),this._game.gameOverManager.start();break;case b.RIP:this._game.showPage(this._game.ripPage),this._game.ripManager.start();break;case b.BAG:this._game.showPage(this._game.bagPage),this._game.bagManager.start();break;case b.ITEM_PICKER:this._game.showPage(this._game.itemPickerPage),this._game.itemPickerManager.start();break;case b.SKILL_UP:this._game.showPage(this._game.skillUpPage),this._game.skillUpManager.start();break;case b.DIALOG:this._game.showPage(this._game.dialogPage),this._game.dialogManager.start();break;case b.MAP:this._game.showPage(this._game.mapPage),this._game.mapManager.start()}}goToState(e){this.currentState!=b.GAME_OVER&&(this.currentState=e,this.setState())}}class g{constructor(e,t,s=100,a=100,i=100,r,n){this._health=100,this._stamina=100,this._hungry=100,this._status=[],this._isDead=!1,this._buried=!1,this._sick=!1,this._name=e,this._kinship=t,this._health=s,this._stamina=a,this._hungry=i,this._dateOfBirth=r,this._isDead=n,this._game=J.getInstance()}get name(){return this._name}get isDead(){return this._isDead}get health(){return this._health}get stamina(){return this._stamina}get kinship(){return this._game.loc.l(this._kinship)}get hungry(){return this._hungry}get buried(){return this._buried}set buried(e){this._buried=e}get imageURL(){return this._imageURL}set imageURL(e){this._imageURL=e}walkOneHour(){for(let e of this._status)this.looseHealth(e.healthPerHour),this._game.logManager.addTempLog(this._name+" has "+e.name,M.Result)}showHealthLostPerHourDueToAllStatus(){let e=0;for(let t of this._status)e+=t.healthPerHour;return e}checksIfAnStatusExists(e){return -1!=this._status.findIndex(t=>t.name==e)}addStatus(e){this.checksIfAnStatusExists(e.name)||(this._game.logManager.addTempLog(this._name+" got: "+e.name,M.Result),this._status.push(e))}removeStatus(e){this._status=this._status.filter(t=>t!==e)}showAfflictions(){if(0==this._status.length)return"";let e="";for(let t of this._status)t&&(e+=" -"+t.name);return e}increaseHungry(){this._hungry<=0?(this.looseHealth(10),this._isDead&&this._game.log.addTempLog(this._name+" starved to death at day "+this._game.currentDay,M.StatusChange)):this._hungry=this._hungry-5}increaseStaminaToMax(){this._stamina=100}increaseStamina(){this._stamina=20}decreaseStamina(e){if(e<=0)throw Error("Stamina value must be greater than zero");this._stamina=this._stamina-e,this._stamina<=0&&(this._stamina=0,this.looseHealth(20),this._isDead?this._game.log.addTempLog(this._name+" died of exhaustion at day "+this._game.currentDay,M.StatusChange):this._game.log.addTempLog(this._name+" is dying of tiredness",M.Result))}decreaseHungry(e){if(e<0)throw Error("Hungry to decrease value must be greater than zero");this._hungry<100&&(this._hungry=this._hungry+e),this._hungry>100&&(this._hungry=100)}getHungry(){return"\uD83E\uDD6B"+this._hungry+"%"}getHealth(){return"❤️"+this._health+"%"}getStamina(){return"⚡"+this._stamina+"%"}getSickness(){return this._sick?"Sick":"Not sick"}getDateOfBirth(){return this._dateOfBirth}sicken(){this._sick=!0}looseHealth(e){if(e<0||e>100)throw Error("Invalid value for healthToLoose");this._health>0&&(this._health-=e,this._health<=0&&(this._health=0,this._isDead=!0,"you"==this._kinship&&this._game.stateManager.goToState(b.GAME_OVER)))}increaseHealth(e){this._health+=e,this._health>100&&(this._health=100)}}class d{constructor(e,t){this._name=e,this._healthPerHour=t}get name(){return this._name}get healthPerHour(){return this._healthPerHour}}class _{static{this.items=[new d("Anxiety",5),new d("Blood loss",30),new d("Broken ribs",25),new d("Depressed",5),new d("Dysentery",30),new d("Fear",10),new d("Food poisoning",20),new d("Infection",10),new d("Pain",5),new d("Wounds",15)]}static getStatusByName(e){return _.items.find(t=>t.name==e)}static getOneRandomStatus(){return _.items[_.getRandomArbitrary(0,_.items.length)]}static getRandomArbitrary(e,t){return Math.floor(Math.random()*(t-e)+e)}}class p{constructor(){this.previousCharacters=[],this.characters=[],this._game=J.getInstance(),this.createAllCharacters(),this.savePreviousCharacters()}start(){for(let e=0;e<this._game.characters.length;e++)this._game.characters[e].imageURL=document.getElementById("rip-page-image-"+(e+1)).src}createAllCharacters(){this.characters.push(new g("Ethan","you",100,100,100,"1985",!1)),this.characters.push(new g("Olivia","wife",100,100,100,"1988",!1)),this.characters.push(new g("Michael","son",100,100,100,"2003",!1)),this.characters.push(new g("Sophia","daughter",100,100,100,"2005",!1))}savePreviousCharacters(){for(let e of(this.previousCharacters=[],this.characters))this.previousCharacters.push(new g(e.name,e.kinship,e.health,e.stamina,e.hungry,e.getDateOfBirth(),e.isDead))}increaseHungryOfAllCharacters(){for(let e of this.getCharactersAlive())e.increaseHungry()}decreaseStaminaOfAllCharacters(e){for(let t of this.getCharactersAlive())t.decreaseStamina(e)}increaseStaminaOfAllCharactersToMax(){for(let e of this.getCharactersAlive())e.increaseStaminaToMax()}increaseStaminaOfAllCharacters(){for(let e of this.getCharactersAlive())e.increaseStamina()}getNumberOfCharactersAlive(){return this._game.characters.filter(e=>!e.isDead).length}getCharactersAlive(){return this._game.characters.filter(e=>!e.isDead)}getCharactersDead(){return this._game.characters.filter(e=>e.isDead)}getFirstCharacterDeadAndNotBuried(){return this._game.characters.find(e=>e.isDead&&!e.buried)}isInDanger(){for(let e of this.getCharactersAlive())if(e.health<=25||e.stamina<=25||e.hungry<=25)return!0;return!1}picksACharacterAtRandom(){let e=this.getCharactersAlive(),t=this._game.getRandomArbitrary(e.length-1);return e[t]}makeSomeoneInTheGroupGetStatus(e){let t=this.picksACharacterAtRandom();return null!=e?t.addStatus(_.getStatusByName(e)):t.addStatus(_.getOneRandomStatus()),t}decreasesTheHealthOfSomeoneInTheGroup(){let e=this.picksACharacterAtRandom();return e.looseHealth(30),e}statusOfTheCharactersChange(){for(let e=0;e<this.previousCharacters.length;e++)if(!this.previousCharacters[e].isDead&&(this.previousCharacters[e].health!=this.characters[e].health||this.previousCharacters[e].stamina!=this.characters[e].stamina||this.previousCharacters[e].hungry!=this.characters[e].hungry))return this.previousCharacters=this.characters,!0;return!1}}var y,k,C,L,f,E,T,v,w,I,S,b,M,B,A,R,P,D,H,x,F={};F=JSON.parse('{"walk-one-hour":"Walk (+1 hour)","your-family":"Your Family","miles-to-the-border":"miles to the border","you":"you","wife":"wife","son":"son","daughter":"daughter","day":"day","daylight":"daylight","strength":"Strength","speak":"Speak","stealth":"Stealth","exploration":"Exploration","bag-is-empty":"Bag is empty"}');var G={};G=JSON.parse('{"walk-one-hour":"Andar (+1 hora)","your-family":"Sua Família","miles-to-the-border":"milhas até a fronteira","you":"você","wife":"esposa","son":"filho","daughter":"filha","day":"dia","daylight":"luz do dia","strength":"Força","speak":"Labia","stealth":"Furtividade","exploration":"Exploração","bag-is-empty":"A bolsa esta vazia"}'),(y=D||(D={}))[y.EnUs=0]="EnUs",y[y.PtBr=1]="PtBr";class O{constructor(e){this._game=J.getInstance(),this._currentLanguage=e}l(e){switch(this._currentLanguage){case 0:return F[e];case 1:return G[e];default:return"Localization Error"}}}class N{constructor(){this._game=J.getInstance()}start(){}}class V{constructor(){this._game=J.getInstance()}start(){}}class q{constructor(){this._game=J.getInstance()}start(){}}class Y{constructor(e,t){this._currentHour=e,this._anteMeridiem=t}get currentHour(){return this._currentHour}get anteMeridiem(){return this._anteMeridiem}nextHour(){11==this._currentHour&&(this._anteMeridiem=!this._anteMeridiem),12==this._currentHour?this._currentHour=1:this._currentHour++}showTime(){return(this._currentHour<=9?"0":"")+this._currentHour.toString()+":00 "+(this._anteMeridiem?"a.m":"p.m")}}(k=H||(H={}))[k.FirstAid=0]="FirstAid",k[k.Food=1]="Food";class U{static{this.items=[new c("Bandages",P.FirstAid,10,[_.getStatusByName("Blood ribs"),_.getStatusByName("Broken ribs")]),new c("Herbal Meds",P.FirstAid,5,[_.getStatusByName("Anxiety")]),new c("Antibiotics",P.FirstAid,15,[_.getStatusByName("Infection"),_.getStatusByName("Food poisoning"),_.getStatusByName("Dysentery")]),new c("Antiseptic",P.FirstAid,15,[_.getStatusByName("Wounds")]),new c("Painkillers",P.FirstAid,15,[_.getStatusByName("Pain"),_.getStatusByName("Broken ribs")]),new c("Raw Food",P.Food,10),new c("Vegetables",P.Food,5),new c("Canned Food",P.Food,10),new c("Cigarette",P.Food,15),new c("Beef jerky",P.Food,15),new c("Bear meat",P.Food,15),new c("Chocolate Bar",P.Food,20),new c("Condensed milk",P.Food,15),new c("Cup of coffee",P.Food,10),new c("Cup of herbal tea",P.Food,10),new c("Dog food",P.Food,15),new c("Energy bar",P.Food,25),new c("Water (unsafe)",P.Food,10),new c("Granola bar",P.Food,15),new c("Orange soda",P.Food,20)]}static getItens(e,t){return this.items[e].amount=t,this.items[e]}static getOneRandomItem(){return U.items[U.getRandomArbitrary(0,U.items.length)]}static getRandomArbitrary(e,t){return Math.floor(Math.random()*(t-e)+e)}}class W{constructor(){}roll(){let e=Math.ceil(1);return Math.floor(Math.random()*(Math.floor(6)-e+1))+e}}(C=x||(x={}))[C.Success=0]="Success",C[C.Failure=1]="Failure";class z{constructor(){this._game=J.getInstance(),this._resultLabel=document.querySelector("#skill-check-result-label"),this._skillCheckResultValue=document.querySelector("#skill-check-result-value"),this._skillCheckResultValueLabel=document.querySelector("#skill-check-result-value-label"),this._travelBtn=document.querySelector("#skill-check-back-btn"),this._firstDice=document.querySelector("#first-dice"),this._secondDice=document.querySelector("#second-dice"),this._skillCheckExpected=document.querySelector("#skill-check-expected"),this._travelBtn.addEventListener("click",()=>{this.onClickTravel()}),this._diceManager=new r("teste")}start(){this._travelBtn.disabled=!0,this._resultLabel.style.visibility="hidden",setTimeout(()=>{this.startDiceRoll()},100)}startDiceRoll(){let e=new W;this._game.audioManager.playDiceSound(),this._diceTimer=setInterval(()=>{this.shakeDice(e)},50),setTimeout(()=>{this.stopShakeDice(e)},500),this._currentChoice=this._game.eventManager.currentChoice}onClickTravel(){if(this._game.audioManager.playButtonSound(),0==this._game.skillCheckResult){if(this._currentChoice.skillCheckFields.resultPath.success(),this._currentChoice.skillCheckFields.canGiveItems){this._game.stateManager.goToState(b.ITEM_PICKER);return}}else 1==this._game.skillCheckResult&&this._currentChoice.skillCheckFields.resultPath.failure();this._game.stateManager.goToState(b.LOG)}shakeDice(e){let t=e.roll(),s=e.roll();this.showDiceValues(t,s)}stopShakeDice(e){clearInterval(this._diceTimer),this._resultLabel.style.visibility="visible";let t=e.roll(),s=e.roll(),a=this._currentChoice.skillCheckFields.difficult.value,i=t+s+3;if(this.showDiceValues(t,s),this._skillCheckResultValue.style.textAlign="center",this._skillCheckResultValue.innerHTML=i.toString(),this._skillCheckExpected.innerHTML="Expected: "+a.toString(),this._travelBtn.disabled=!1,t+s==12){this._game.audioManager.playSuccessSound(),this.setCriticalSuccess(),this._game.skillCheckResult=0;return}if(t+s==2){this._game.audioManager.playFailSound(),this.setCriticalFailure(),this._game.skillCheckResult=1;return}if(i>=a){this._game.audioManager.playSuccessSound(),this.setSuccess(),this._game.skillCheckResult=0;return}if(i<a){this._game.audioManager.playFailSound(),this.setFailure(),this._game.skillCheckResult=1;return}}showDiceValues(e,t){this._firstDice.innerHTML=e.toString(),this._secondDice.innerHTML=t.toString()}setCriticalSuccess(){this._skillCheckResultValue.style.visibility="hidden",this._skillCheckResultValueLabel.style.visibility="hidden",this._skillCheckResultValue.classList.remove("red-color"),this._skillCheckResultValue.classList.add("green-color"),this._firstDice.classList.add("green-color"),this._secondDice.classList.add("green-color"),this._firstDice.classList.remove("red-color"),this._secondDice.classList.remove("red-color"),this._resultLabel.innerHTML=" CRITICIAL SUCCESS ",this._resultLabel.style.fontSize="1.3em",this._resultLabel.classList.remove("red-color"),this._resultLabel.classList.add("green-color")}setSuccess(){this._skillCheckResultValue.style.visibility="visible",this._skillCheckResultValueLabel.style.visibility="visible",this._skillCheckResultValue.classList.remove("red-color"),this._skillCheckResultValue.classList.add("green-color"),this._firstDice.classList.remove("green-color"),this._secondDice.classList.remove("green-color"),this._firstDice.classList.remove("red-color"),this._secondDice.classList.remove("red-color"),this._resultLabel.innerHTML=" SUCCESS ",this._resultLabel.style.fontSize="2.5em",this._resultLabel.classList.remove("red-color"),this._resultLabel.classList.add("green-color")}setCriticalFailure(){this._skillCheckResultValue.style.visibility="hidden",this._skillCheckResultValueLabel.style.visibility="hidden",this._skillCheckResultValue.classList.add("red-color"),this._skillCheckResultValue.classList.remove("green-color"),this._firstDice.classList.remove("green-color"),this._secondDice.classList.remove("green-color"),this._firstDice.classList.add("red-color"),this._secondDice.classList.add("red-color"),this._resultLabel.innerHTML=" CRITICIAL FAILURE ",this._resultLabel.style.fontSize="1.3em",this._resultLabel.classList.add("red-color"),this._resultLabel.classList.remove("green-color")}setFailure(){this._skillCheckResultValue.style.visibility="visible",this._skillCheckResultValueLabel.style.visibility="visible",this._skillCheckResultValue.classList.add("red-color"),this._skillCheckResultValue.classList.remove("green-color"),this._firstDice.classList.remove("green-color"),this._secondDice.classList.remove("green-color"),this._firstDice.classList.remove("red-color"),this._secondDice.classList.remove("red-color"),this._resultLabel.innerHTML=" FAILURE ",this._resultLabel.style.fontSize="2.5em",this._resultLabel.classList.add("red-color"),this._resultLabel.classList.remove("green-color")}}class K{constructor(){this._itemsToPick=[],this._myItems=[],this._myItemsMax=2,this.itemsFound=4,this._game=J.getInstance(),this._continueBtn=document.querySelector("#item-picker-page-continue-btn"),this._continueBtn.addEventListener("click",()=>{this.onContinueBtn()}),this._itemsToPickListElement=document.querySelector("#item-picker-page-items-to-pick"),this._itemsFoundTitle=document.querySelector("#items-found-title"),this._pageMessageElement=document.querySelector("#item-picker-page-message"),this._myItemsListElement=document.querySelector("#item-picker-page-item-my-items"),this._yourItemsTitle=document.querySelector("#your-items-title"),this._takeAllBtn=document.querySelector("#item-picker-page-take-all-btn")}start(){this.showPageMessage(),this._itemsToPick=[],this._myItems=[],this.character=this._game.characterManager.picksACharacterAtRandom();for(let e=0;e<this.itemsFound;e++){let e=U.getOneRandomItem();this.addItemToPick(e)}this.showItems()}showPageMessage(){this._itemsFoundTitle.style.display="none",this._continueBtn.style.display="none",this._itemsToPickListElement.style.display="none",this._myItemsListElement.style.display="none",this._yourItemsTitle.style.display="none",this._takeAllBtn.style.display="none",this._pageMessageElement.style.display="block",setTimeout(()=>this.showPageElements(),1500)}showPageElements(){this._itemsFoundTitle.style.display="block",this._continueBtn.style.display="block",this._itemsToPickListElement.style.display="block",this._myItemsListElement.style.display="block",this._yourItemsTitle.style.display="block",this._takeAllBtn.style.display="block",this._pageMessageElement.style.display="none"}showItems(){this._itemsToPick.length<=this._myItemsMax-this._myItems.length?this._takeAllBtn.disabled=!1:this._takeAllBtn.disabled=!0,this.showItemsToPick(),this.showMyItems()}showItemsToPick(){for(let e of(this._itemsToPickListElement.innerHTML="",this._itemsToPick)){let t=document.createElement("li"),s=document.createElement("button");s.appendChild(document.createTextNode(e.name+" ("+e.effect+") "+e.showAmount())),s.addEventListener("click",()=>this.selectItemToPick(e)),this._myItems.length>=this._myItemsMax&&(s.disabled=!0),t.appendChild(s),this._itemsToPickListElement.appendChild(t)}}showMyItems(){for(let e of(this._yourItemsTitle.innerHTML="Your items - ("+this._myItems.length+"/"+this._myItemsMax+")",this._myItemsListElement.innerHTML="",this._myItems)){let t=document.createElement("li"),s=document.createElement("button");s.appendChild(document.createTextNode(e.name+" ("+e.effect+") "+e.showAmount())),s.addEventListener("click",()=>this.selectItemMyItem(e)),t.appendChild(s),this._myItemsListElement.appendChild(t)}}selectItemToPick(e){this._game.audioManager.playTakeItemSound(),this.removeItemToPick(e.name),this.addMyItem(e),this.showItems()}selectItemMyItem(e){this._game.audioManager.playThrowSound(),this.removeMyItem(e.name),this.addItemToPick(e),this.showItems()}removeItemToPick(e){this._itemsToPick=this._itemsToPick.filter(t=>t.name!==e)}removeMyItem(e){this._myItems=this._myItems.filter(t=>t.name!==e)}addItemToPick(e){let t=this._itemsToPick.findIndex(t=>t.name==e.name);t>=0?this._itemsToPick[t].increaseAmount():this._itemsToPick.push(e)}addMyItem(e){let t=this._myItems.findIndex(t=>t.name==e.name);t>=0?this._myItems[t].increaseAmount():this._myItems.push(e)}onContinueBtn(){this._game.audioManager.playButtonSound();for(let e=0;e<this._myItems.length;e++)this._game.bagManager.putItem(this._myItems[e]),this._game.log.addTempLog(this.character.name+" picked up "+this._myItems[e].name,M.Result);this._game.stateManager.goToState(b.LOG)}}class j{constructor(){for(let e in this.audioFiles=[],this.noSound=!1,this._game=J.getInstance(),this.audioFiles=["success.wav","button1.wav","dice.mp3","fail.mp3","take-item.wav","write.wav","throw.wav","ding.wav","walk.mpeg"],this.audioEffects=new Audio,this.audioBackground=new Audio,this.audioFiles)this.preloadAudio(this.audioFiles[e])}preloadAudio(e){let t=new Audio;t.addEventListener("canplaythrough",this.loadedAudio,!1),t.src=e}loadedAudio(){this.audioLoaded++,this.audioLoaded==this.audioFiles.length-1&&this.allAudioHaveBeenLoaded()}allAudioHaveBeenLoaded(){console.log("load all audios")}playButtonSound(){this.playAudioEffect("button1.wav")}playDiceSound(){this.playAudioEffect("dice.mp3")}playSuccessSound(){this.playAudioEffect("success.wav")}playFailSound(){this.playAudioEffect("fail.mp3")}playTakeItemSound(){this.playAudioEffect("take-item.wav")}playWriteSound(){this.playAudioEffect("write.wav")}playThrowSound(){this.playAudioEffect("throw.wav")}playDingSound(){this.playAudioEffect("ding.wav")}playRainSound(){this.playAudioLoop("walk.mpeg")}playAudioEffect(e){this.noSound||(this.audioEffects.src="audio/"+e,this.audioEffects.play())}playAudioLoop(e){this.noSound||(this.audioBackground.src="audio/"+e,this.audioBackground.volume=.2,"boolean"==typeof this.audioBackground.loop?this.audioBackground.loop=!0:this.audioBackground.addEventListener("ended",function(){this.currentTime=0,this.play(),console.log("loop")},!1),this.audioBackground.play())}}class J{constructor(){this._currentDay=1,this._hours=0,this._distanceToTheBorder=300,this.travelPage=document.getElementById("travel-page"),this.logPage=document.getElementById("log-page"),this.eventPage=document.getElementById("event-page"),this.skillCheckPage=document.getElementById("skill-check-page"),this.gameOverPage=document.getElementById("game-over-page"),this.ripPage=document.getElementById("rip-page"),this.bagPage=document.getElementById("bag-page"),this.itemPickerPage=document.getElementById("item-picker-page"),this.dialogPage=document.querySelector("#dialog-page"),this.mapPage=document.querySelector("#map-page"),this.skillUpPage=document.querySelector("#skill-up-page"),this._currentTimeField=document.querySelector("#current-time-field"),this.playerGuid=this.generateGuid()}static getInstance(){return J._instance||(J._instance=new J),J._instance}start(){this.loc=new O(D.EnUs),new r("dice-canvas").start(),this.bagManager=new u,this.characterManager=new p,this.characterManager.start(),this.eventManager=new n,this.gameOverManager=new h,this.skillCheckManager=new z,this.ripManager=new o,this.travelManager=new l,this._clock=new Y(8,!0),this.logManager=new t,this.stateManager=new m,this.itemPickerManager=new K,this.dialogManager=new N,this.mapManager=new V,this.skillUpManager=new q,this.audioManager=new j,this.showDataTime(),this.stateManager.goToState(b.TRAVEL)}get events(){return this.eventManager}get log(){return this.logManager}get clock(){return this._clock}get hours(){return this._hours}set hours(e){this._hours=e}get currentDay(){return this._currentDay}get distanceToTheBorder(){return this._distanceToTheBorder}get characters(){return this.characterManager.characters}decreaseTheDistanceToTheBorder(e){this._distanceToTheBorder-=e}addDaysToCurrentDay(e){this._currentDay+=e}addItemsToBag(){for(let e=0;e<10;e++)this.bagManager.putItem(U.getOneRandomItem())}showPage(e){e.style.display="flex"}hidePage(e){e.style.display="none"}hideAllPages(){this.hidePage(this.travelPage),this.hidePage(this.logPage),this.hidePage(this.eventPage),this.hidePage(this.skillCheckPage),this.hidePage(this.gameOverPage),this.hidePage(this.bagPage),this.hidePage(this.ripPage),this.hidePage(this.itemPickerPage),this.hidePage(this.skillUpPage),this.hidePage(this.dialogPage),this.hidePage(this.mapPage)}showDataTime(){this._currentTimeField.innerHTML=this._clock.showTime()+" - day "+this._currentDay,this.isDayLight()?this._currentTimeField.innerHTML+=" - daylight":this._currentTimeField.innerHTML+=" - night"}isDayLight(){return this._clock.anteMeridiem?this._clock.currentHour>6&&this._clock.currentHour<12:!(this._clock.currentHour>6)||!(this._clock.currentHour<12)}passOneHour(){12==this._clock.currentHour&&this._clock.anteMeridiem&&this.addDaysToCurrentDay(1),this._clock.nextHour(),this.showDataTime()}generateGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}getRandomArbitrary(e){return Math.floor(Math.random()*e)}}J.getInstance().start();
//# sourceMappingURL=index.2c0c1863.js.map
